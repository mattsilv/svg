<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SVG Drop</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=DM+Sans:wght@400;500;600;700&display=swap');

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg: #0a0a0b;
    --surface: #131316;
    --surface-2: #1a1a1f;
    --surface-3: #222228;
    --border: #2a2a32;
    --border-hover: #3a3a44;
    --text: #e8e8ed;
    --text-dim: #8888a0;
    --text-muted: #55556a;
    --accent: #00d4aa;
    --accent-dim: #00d4aa22;
    --accent-glow: #00d4aa44;
    --danger: #ff4466;
    --mono: 'JetBrains Mono', monospace;
    --sans: 'DM Sans', sans-serif;
    --radius: 8px;
    --radius-lg: 12px;
  }

  html { font-size: 15px; }

  body {
    font-family: var(--sans);
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
  }

  /* ── Layout ── */
  .app {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem 1.5rem 4rem;
  }

  header {
    margin-bottom: 2.5rem;
    padding-bottom: 1.5rem;
    border-bottom: 1px solid var(--border);
  }

  .header-top {
    display: flex;
    align-items: baseline;
    gap: 0.75rem;
    margin-bottom: 1rem;
  }

  .intro {
    font-size: 0.85rem;
    color: var(--text-dim);
    line-height: 1.7;
    max-width: 720px;
  }

  .intro a {
    color: var(--accent);
    text-decoration: none;
    border-bottom: 1px solid var(--accent-dim);
    transition: border-color 0.15s;
  }
  .intro a:hover { border-color: var(--accent); }

  .intro .tip {
    display: inline-block;
    margin-top: 0.5rem;
    font-family: var(--mono);
    font-size: 0.75rem;
    color: var(--text-muted);
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 0.5rem 0.75rem;
    line-height: 1.6;
  }

  header h1 {
    font-family: var(--mono);
    font-size: 1.4rem;
    font-weight: 700;
    letter-spacing: -0.03em;
    color: var(--accent);
  }

  header span {
    font-size: 0.8rem;
    color: var(--text-muted);
    font-family: var(--mono);
    font-weight: 300;
  }

  .layout {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
    align-items: start;
  }

  @media (max-width: 800px) {
    .layout { grid-template-columns: 1fr; }
  }

  /* ── Input Panel ── */
  .panel {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    overflow: hidden;
  }

  .panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.75rem 1rem;
    border-bottom: 1px solid var(--border);
    background: var(--surface-2);
  }

  .panel-title {
    font-family: var(--mono);
    font-size: 0.75rem;
    font-weight: 500;
    color: var(--text-dim);
    text-transform: uppercase;
    letter-spacing: 0.08em;
  }

  .btn-clear {
    font-family: var(--mono);
    font-size: 0.7rem;
    color: var(--text-muted);
    background: none;
    border: 1px solid transparent;
    padding: 0.25rem 0.6rem;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.15s;
  }
  .btn-clear:hover {
    color: var(--danger);
    border-color: var(--danger);
  }

  #svgInput {
    width: 100%;
    min-height: 320px;
    padding: 1rem;
    background: transparent;
    border: none;
    color: var(--text);
    font-family: var(--mono);
    font-size: 0.8rem;
    line-height: 1.6;
    resize: vertical;
    outline: none;
  }

  #svgInput::placeholder {
    color: var(--text-muted);
  }

  .input-footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.6rem 1rem;
    border-top: 1px solid var(--border);
    background: var(--surface-2);
  }

  #parseStatus {
    font-family: var(--mono);
    font-size: 0.7rem;
    color: var(--text-muted);
  }
  #parseStatus.ok { color: var(--accent); }
  #parseStatus.err { color: var(--danger); }

  /* ── Preview Panel ── */
  .preview-panel { min-height: 320px; }

  .preview-toolbar {
    display: flex;
    gap: 0.25rem;
  }

  .toolbar-btn {
    font-family: var(--mono);
    font-size: 0.65rem;
    color: var(--text-muted);
    background: none;
    border: 1px solid transparent;
    padding: 0.2rem 0.5rem;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.15s;
  }
  .toolbar-btn:hover { color: var(--text-dim); border-color: var(--border); }
  .toolbar-btn.active { color: var(--accent); border-color: var(--accent-dim); background: var(--accent-dim); }

  .preview-area {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 280px;
    padding: 1.5rem;
  }

  .checkerboard {
    background-image:
      linear-gradient(45deg, var(--surface-2) 25%, transparent 25%),
      linear-gradient(-45deg, var(--surface-2) 25%, transparent 25%),
      linear-gradient(45deg, transparent 75%, var(--surface-2) 75%),
      linear-gradient(-45deg, transparent 75%, var(--surface-2) 75%);
    background-size: 16px 16px;
    background-position: 0 0, 0 8px, 8px -8px, -8px 0;
  }

  .bg-dark .preview-area { background: #000; }
  .bg-light .preview-area { background: #fff; }

  #previewContainer {
    max-width: 100%;
    max-height: 400px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  #previewContainer svg {
    max-width: 100%;
    max-height: 360px;
    height: auto;
  }

  .empty-state {
    text-align: center;
    color: var(--text-muted);
    font-family: var(--mono);
    font-size: 0.8rem;
    line-height: 2;
  }

  .empty-state .arrow {
    font-size: 1.8rem;
    color: var(--border);
    display: block;
    margin-bottom: 0.5rem;
  }

  /* ── Export Section ── */
  .export-section {
    grid-column: 1 / -1;
    margin-top: 0.5rem;
  }

  .export-section.hidden { display: none; }

  .section-label {
    font-family: var(--mono);
    font-size: 0.7rem;
    font-weight: 500;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.08em;
    margin-bottom: 0.75rem;
  }

  /* ── Presets Grid ── */
  .presets-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 1.5rem;
  }

  .preset-btn {
    font-family: var(--mono);
    font-size: 0.75rem;
    font-weight: 500;
    color: var(--text-dim);
    background: var(--surface);
    border: 1px solid var(--border);
    padding: 0.5rem 0.9rem;
    border-radius: var(--radius);
    cursor: pointer;
    transition: all 0.15s;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .preset-btn:hover {
    border-color: var(--border-hover);
    color: var(--text);
    background: var(--surface-2);
  }

  .preset-btn.active {
    border-color: var(--accent);
    color: var(--accent);
    background: var(--accent-dim);
  }

  .preset-size {
    font-size: 0.65rem;
    color: var(--text-muted);
    font-weight: 300;
  }

  .preset-btn.active .preset-size { color: var(--accent); opacity: 0.7; }

  /* ── Options Row ── */
  .options-row {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 1.5rem;
    margin-bottom: 1.5rem;
    padding: 1rem 1.25rem;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
  }

  .option-group {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .option-group label {
    font-family: var(--mono);
    font-size: 0.75rem;
    color: var(--text-dim);
    cursor: pointer;
    user-select: none;
    display: flex;
    align-items: center;
    gap: 0.4rem;
  }

  .option-group input[type="checkbox"] {
    appearance: none;
    width: 16px;
    height: 16px;
    border: 1.5px solid var(--border-hover);
    border-radius: 3px;
    background: var(--surface-2);
    cursor: pointer;
    position: relative;
    transition: all 0.15s;
  }

  .option-group input[type="checkbox"]:checked {
    background: var(--accent);
    border-color: var(--accent);
  }

  .option-group input[type="checkbox"]:checked::after {
    content: '';
    position: absolute;
    left: 4px;
    top: 1px;
    width: 5px;
    height: 9px;
    border: solid var(--bg);
    border-width: 0 2px 2px 0;
    transform: rotate(45deg);
  }

  .format-select {
    font-family: var(--mono);
    font-size: 0.75rem;
    color: var(--text);
    background: var(--surface-2);
    border: 1px solid var(--border);
    padding: 0.35rem 0.6rem;
    border-radius: 4px;
    outline: none;
    cursor: pointer;
  }
  .format-select:focus { border-color: var(--accent); }

  .custom-size {
    display: flex;
    align-items: center;
    gap: 0.35rem;
  }

  .size-input {
    font-family: var(--mono);
    font-size: 0.75rem;
    color: var(--text);
    background: var(--surface-2);
    border: 1px solid var(--border);
    padding: 0.35rem 0.5rem;
    border-radius: 4px;
    width: 60px;
    outline: none;
    text-align: center;
  }
  .size-input:focus { border-color: var(--accent); }

  .size-x {
    font-family: var(--mono);
    font-size: 0.7rem;
    color: var(--text-muted);
  }

  /* ── Download Button ── */
  .download-row {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .btn-download {
    font-family: var(--mono);
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--bg);
    background: var(--accent);
    border: none;
    padding: 0.7rem 2rem;
    border-radius: var(--radius);
    cursor: pointer;
    transition: all 0.2s;
    letter-spacing: 0.02em;
  }

  .btn-download:hover {
    background: #00e8bb;
    box-shadow: 0 0 20px var(--accent-glow);
  }

  .btn-download:active { transform: scale(0.98); }

  .btn-download:disabled {
    opacity: 0.3;
    cursor: not-allowed;
    box-shadow: none;
  }

  .download-info {
    font-family: var(--mono);
    font-size: 0.7rem;
    color: var(--text-muted);
  }

  /* ── Animation Warning ── */
  .anim-warning {
    font-family: var(--mono);
    font-size: 0.7rem;
    color: #ffaa33;
    background: #ffaa3311;
    border: 1px solid #ffaa3322;
    padding: 0.5rem 0.75rem;
    border-radius: var(--radius);
    margin-bottom: 1rem;
    display: none;
  }
  .anim-warning.visible { display: block; }

  /* ── Toast ── */
  .toast {
    position: fixed;
    bottom: 2rem;
    left: 50%;
    transform: translateX(-50%) translateY(120%);
    font-family: var(--mono);
    font-size: 0.75rem;
    color: var(--bg);
    background: var(--accent);
    padding: 0.6rem 1.2rem;
    border-radius: var(--radius);
    opacity: 0;
    transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    pointer-events: none;
    z-index: 100;
  }
  .toast.show {
    transform: translateX(-50%) translateY(0);
    opacity: 1;
  }
</style>
</head>
<body>

<div class="app">
  <header>
    <div class="header-top">
      <h1>svg drop</h1>
    </div>
    <div class="intro">
      <strong>Gemini 3.1 Pro</strong> (launched <span id="launchAge"></span>) is incredible at generating SVG files &mdash; icons, logos, animated graphics, you name it. But it gives you raw XML code with no easy way to actually see or use the image. This tool completes the loop: paste the SVG code, preview it instantly, and download it as a ready-to-use PNG, WebP, or SVG at any size.
      <br>
      <span class="tip">To try it: go to <a href="https://gemini.google.com/" target="_blank">gemini.google.com</a>, select <strong>"3.1 Pro"</strong> as your model (not Flash), and ask it to give you the SVG code for any icon or animated image you can think of. Copy the code it gives you and paste it here.</span>
    </div>
  </header>

  <div class="layout">
    <!-- Input -->
    <div class="panel">
      <div class="panel-header">
        <span class="panel-title">svg input</span>
        <div style="display:flex;gap:0.5rem;">
          <button class="btn-clear" onclick="loadExample()">try example</button>
          <button class="btn-clear" onclick="clearInput()">clear</button>
        </div>
      </div>
      <textarea id="svgInput" placeholder="Paste your SVG code here &#10;&#10;(It starts with &lt;svg and ends with &lt;/svg&gt;)" spellcheck="false"></textarea>
      <div class="input-footer">
        <span id="parseStatus"></span>
      </div>
    </div>

    <!-- Preview -->
    <div class="panel preview-panel" id="previewPanel">
      <div class="panel-header">
        <span class="panel-title">preview</span>
        <div class="preview-toolbar">
          <button class="toolbar-btn active" data-bg="checker" onclick="setBg('checker', this)">checker</button>
          <button class="toolbar-btn" data-bg="dark" onclick="setBg('dark', this)">dark</button>
          <button class="toolbar-btn" data-bg="light" onclick="setBg('light', this)">light</button>
        </div>
      </div>
      <div class="preview-area checkerboard" id="previewArea">
        <div id="previewContainer">
          <div class="empty-state">
            <span class="arrow">&larr;</span>
            Paste SVG code on the left<br>or click "try example" above
          </div>
        </div>
      </div>
    </div>

    <!-- Export -->
    <div class="export-section hidden" id="exportSection">
      <div class="section-label">presets</div>
      <div class="presets-grid">
        <button class="preset-btn" data-w="128" data-h="128" onclick="selectPreset(this)">
          Discord avatar <span class="preset-size">128px</span>
        </button>
        <button class="preset-btn" data-w="512" data-h="512" onclick="selectPreset(this)">
          Slack icon <span class="preset-size">512px</span>
        </button>
        <button class="preset-btn" data-w="32" data-h="32" onclick="selectPreset(this)">
          Favicon <span class="preset-size">32px</span>
        </button>
        <button class="preset-btn" data-w="400" data-h="400" onclick="selectPreset(this)">
          GitHub avatar <span class="preset-size">400px</span>
        </button>
        <button class="preset-btn active" data-w="256" data-h="256" onclick="selectPreset(this)">
          Social icon <span class="preset-size">256px</span>
        </button>
        <button class="preset-btn" data-w="1024" data-h="1024" onclick="selectPreset(this)">
          High-res <span class="preset-size">1024px</span>
        </button>
        <button class="preset-btn" data-w="0" data-h="0" onclick="selectPreset(this)">
          Custom size
        </button>
      </div>

      <div class="options-row">
        <div class="option-group">
          <label>
            <input type="checkbox" id="optTransparent" checked onchange="updateOptions()">
            Transparent
          </label>
        </div>
        <div class="option-group">
          <label>
            <input type="checkbox" id="optCircle" onchange="updateOptions()">
            Circle crop
          </label>
        </div>
        <div class="option-group">
          <label class="size-x">Format</label>
          <select class="format-select" id="formatSelect" onchange="updateOptions()">
            <option value="png">PNG</option>
            <option value="svg">SVG</option>
            <option value="webp">WebP</option>
          </select>
        </div>
        <div class="option-group custom-size" id="customSizeGroup" style="display:none;">
          <input type="number" class="size-input" id="customW" value="512" min="1" max="4096" onchange="updateOptions()">
          <span class="size-x">&times;</span>
          <input type="number" class="size-input" id="customH" value="512" min="1" max="4096" onchange="updateOptions()">
        </div>
      </div>

      <div class="anim-warning" id="animWarning">
        Animated SVG detected. PNG/WebP exports capture a static frame. Use SVG format to preserve animation.
      </div>

      <div class="download-row">
        <button class="btn-download" id="downloadBtn" onclick="doDownload()">Download</button>
        <span class="download-info" id="downloadInfo">256 &times; 256 &middot; PNG &middot; transparent</span>
      </div>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
// Launch date
const launch = new Date('2026-02-19');
const days = Math.floor((new Date() - launch) / 86400000);
document.getElementById('launchAge').textContent =
  days <= 0 ? 'today' : days === 1 ? 'yesterday' : days + ' days ago';

const svgInput = document.getElementById('svgInput');
const previewContainer = document.getElementById('previewContainer');
const previewArea = document.getElementById('previewArea');
const previewPanel = document.getElementById('previewPanel');
const exportSection = document.getElementById('exportSection');
const parseStatus = document.getElementById('parseStatus');
const downloadBtn = document.getElementById('downloadBtn');
const downloadInfo = document.getElementById('downloadInfo');
const animWarning = document.getElementById('animWarning');
const toast = document.getElementById('toast');

let currentSvg = null;
let isAnimated = false;
let selectedW = 256, selectedH = 256;
let isCustom = false;

// ── Parse & Render ──
svgInput.addEventListener('input', debounce(parseSvg, 150));

function parseSvg() {
  const raw = svgInput.value.trim();
  if (!raw) {
    previewContainer.innerHTML = '<div class="empty-state"><span class="arrow">&larr;</span>paste svg to preview</div>';
    parseStatus.textContent = '';
    parseStatus.className = '';
    exportSection.classList.add('hidden');
    currentSvg = null;
    return;
  }

  try {
    const parser = new DOMParser();
    const doc = parser.parseFromString(raw, 'image/svg+xml');
    const err = doc.querySelector('parsererror');
    if (err) throw new Error(err.textContent.split('\n')[0]);

    const svg = doc.documentElement;
    if (svg.tagName !== 'svg') throw new Error('Root element is not <svg>');

    // Ensure xmlns
    if (!svg.getAttribute('xmlns')) {
      svg.setAttribute('xmlns', 'http://www.w3.org/2000/svg');
    }

    currentSvg = new XMLSerializer().serializeToString(svg);

    // Check animated
    isAnimated = /<animate|<animateTransform|<animateMotion|<set /i.test(currentSvg)
      || /animation|@keyframes/i.test(currentSvg);

    animWarning.classList.toggle('visible', isAnimated);

    // Render preview
    previewContainer.innerHTML = '';
    const clone = svg.cloneNode(true);
    previewContainer.appendChild(clone);

    parseStatus.textContent = 'valid svg';
    parseStatus.className = 'ok';
    exportSection.classList.remove('hidden');
    updateOptions();
  } catch (e) {
    parseStatus.textContent = e.message.slice(0, 60);
    parseStatus.className = 'err';
    exportSection.classList.add('hidden');
    currentSvg = null;
  }
}

// ── Background Toggle ──
function setBg(mode, btn) {
  document.querySelectorAll('.preview-toolbar .toolbar-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  previewArea.className = 'preview-area' + (mode === 'checker' ? ' checkerboard' : '');
  previewPanel.className = 'panel preview-panel' + (mode === 'dark' ? ' bg-dark' : mode === 'light' ? ' bg-light' : '');
}

// ── Presets ──
function selectPreset(btn) {
  document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  const w = parseInt(btn.dataset.w), h = parseInt(btn.dataset.h);
  isCustom = w === 0;
  document.getElementById('customSizeGroup').style.display = isCustom ? 'flex' : 'none';
  if (!isCustom) { selectedW = w; selectedH = h; }
  updateOptions();
}

// ── Options ──
function updateOptions() {
  if (isCustom) {
    selectedW = parseInt(document.getElementById('customW').value) || 256;
    selectedH = parseInt(document.getElementById('customH').value) || 256;
  }
  const fmt = document.getElementById('formatSelect').value;
  const transparent = document.getElementById('optTransparent').checked;
  const circle = document.getElementById('optCircle').checked;

  const parts = [];
  if (fmt !== 'svg') parts.push(`${selectedW} &times; ${selectedH}`);
  parts.push(fmt.toUpperCase());
  if (transparent && fmt !== 'svg') parts.push('transparent');
  if (circle && fmt !== 'svg') parts.push('circle');

  downloadInfo.innerHTML = parts.join(' &middot; ');
}

// ── Download ──
async function doDownload() {
  if (!currentSvg) return;

  const fmt = document.getElementById('formatSelect').value;
  const transparent = document.getElementById('optTransparent').checked;
  const circle = document.getElementById('optCircle').checked;

  if (fmt === 'svg') {
    downloadBlob(new Blob([currentSvg], { type: 'image/svg+xml' }), `icon.svg`);
    showToast('SVG downloaded');
    return;
  }

  try {
    downloadBtn.disabled = true;
    const blob = await rasterize(currentSvg, selectedW, selectedH, fmt, transparent, circle);
    downloadBlob(blob, `icon-${selectedW}x${selectedH}.${fmt}`);
    showToast(`${fmt.toUpperCase()} downloaded`);
  } catch (e) {
    showToast('Export failed: ' + e.message);
  } finally {
    downloadBtn.disabled = false;
  }
}

function rasterize(svgStr, w, h, fmt, transparent, circle) {
  return new Promise((resolve, reject) => {
    const blob = new Blob([svgStr], { type: 'image/svg+xml;charset=utf-8' });
    const url = URL.createObjectURL(blob);
    const img = new Image();
    img.onload = () => {
      const canvas = document.createElement('canvas');
      canvas.width = w;
      canvas.height = h;
      const ctx = canvas.getContext('2d');

      if (!transparent) {
        ctx.fillStyle = '#ffffff';
        ctx.fillRect(0, 0, w, h);
      }

      if (circle) {
        ctx.beginPath();
        ctx.arc(w / 2, h / 2, Math.min(w, h) / 2, 0, Math.PI * 2);
        ctx.clip();
      }

      // Scale SVG to fill canvas while maintaining aspect ratio
      const svgAspect = img.naturalWidth / img.naturalHeight;
      const canvasAspect = w / h;
      let dw, dh, dx, dy;
      if (svgAspect > canvasAspect) {
        dh = h; dw = h * svgAspect;
        dx = (w - dw) / 2; dy = 0;
      } else {
        dw = w; dh = w / svgAspect;
        dx = 0; dy = (h - dh) / 2;
      }
      ctx.drawImage(img, dx, dy, dw, dh);

      URL.revokeObjectURL(url);
      const mime = fmt === 'webp' ? 'image/webp' : 'image/png';
      canvas.toBlob(b => b ? resolve(b) : reject(new Error('Canvas export failed')), mime);
    };
    img.onerror = () => { URL.revokeObjectURL(url); reject(new Error('SVG render failed')); };
    img.src = url;
  });
}

function downloadBlob(blob, filename) {
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = filename;
  a.click();
  setTimeout(() => URL.revokeObjectURL(a.href), 1000);
}

// ── Utilities ──
function clearInput() {
  svgInput.value = '';
  parseSvg();
}

function debounce(fn, ms) {
  let t;
  return (...args) => { clearTimeout(t); t = setTimeout(() => fn(...args), ms); };
}

function loadExample() {
  svgInput.value = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 120" width="120" height="120">
  <defs>
    <linearGradient id="g" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#00d4aa"/>
      <stop offset="100%" stop-color="#0088ff"/>
    </linearGradient>
  </defs>
  <circle cx="60" cy="60" r="56" fill="url(#g)"/>
  <text x="60" y="72" text-anchor="middle" font-size="48" font-family="sans-serif" font-weight="bold" fill="#fff">S</text>
</svg>`;
  parseSvg();
}

function showToast(msg) {
  toast.textContent = msg;
  toast.classList.add('show');
  setTimeout(() => toast.classList.remove('show'), 2000);
}
</script>

</body>
</html>
